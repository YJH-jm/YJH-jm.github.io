---
layout: single
title:  "ë³‘ë ¬ ì²˜ë¦¬ - multiprocessing" # ê¸€ ì œëª©
categories: Python # category
tags: [ë³‘ë ¬ì²˜ë¦¬, multiprocessing] # tag
toc: true # ì˜¤ë¥¸ìª½ì˜ table of contents
toc_sticky: true # ìŠ¤í¬ë¡¤ ë‚´ë ¤ë„ toc ê³ ì •
toc_label: ëª©ì°¨
author_profile: false
# sidebar: # ì™¼ìª½ ì‚¬ì´ë“œ ë°”
    # nav: "docs"
search: true # ê¸€ ê²€ìƒ‰
use_math: ture
# typore-root-url: ../

---

****



### Multiprocessing

#### ğŸ’¡ ìŠ¤ë ˆë“œ(thread) vs. ë©€í‹°í”„ë¡œì„¸ì‹±(multiprocessing)

íŒŒì´ì¬ì—ì„œ ë³‘ë ¬ì²˜ë¦¬ë¥¼ êµ¬í˜„í•˜ëŠ” ë°©ì‹ì€ ë©€í‹° ì“°ë ˆë“œë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ ë©€í‹° í”„ë¡œì„¸ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ë‘ê°€ì§€ ë°©ë²• ì¡´ì¬ <br>



####  ìŠ¤ë ˆë“œ(thread) íŠ¹ì§•

ìŠ¤ë ˆë“œëŠ” ê°€ë³ì§€ë§Œ cpu ê³„ì‚° ì²˜ë¦¬ë¥¼ í•˜ëŠ” ì‘ì—…ì—ëŠ” í•œë²ˆì— í•˜ë‚˜ì˜ ì“°ë ˆë“œì—ì„œë§Œ ì‘ë™í•¨ <br>

cpu ì‘ì—…ì´ ì ê³  **ë„¤íŠ¸ì›Œí¬ í†µì‹ ** ë˜ëŠ” **íŒŒì¼ ì½ê³  ì“°ê¸°ì™€ ê°™ì€ ì‘ì—… (I/O)** ì´ ë§ì€ ë³‘ë ¬ ì²˜ë¦¬ í”„ë¡œê·¸ë¨ì—ì„œ íš¨ê³¼ì 



<br>



#### ë©€í‹°í”„ë¡œì„¸ì‹±(multiprocedssing) íŠ¹ì§•

ë©€í‹° í”„ë¡œì„¸ì„œì™€ ë³„ê°œì˜ ë©”ëª¨ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì™„ì „íˆ ë…ë¦½í•˜ì—¬ ë³‘ë ¬ í”„ë¡œê·¸ë˜ë°ì´ ê°€ëŠ¥  <br>

- Threadê°€ ì•„ë‹Œ Processë¥¼ ë©€í‹°ë¡œ ì‚¬ìš© 

ì—¬ëŸ¬ ê°œì˜ CPUê°€ ìˆëŠ” **ë©€í‹°ì½”ì–´ í™˜ê²½**ì—ì„œ **CPU ìˆ˜ ë§Œí¼ ì‘ì—…ì„ ë‚˜ëˆ„ì–´ ì‹¤í–‰** ê°€ëŠ¥ <br>

í”„ë¡œì„¸ìŠ¤ëŠ” ê°ìê°€ ê³ ìœ í•œ ë©”ëª¨ë¦¬ ì˜ì—­ì„ ê°€ì§€ê¸° ë•Œë¬¸ì— **ë” ë§ì€ ë©”ëª¨ë¦¬ë¥¼ í•„ìš”** <br>

ê°ê° í”„ë¡œì„¸ìŠ¤ì—ì„œ ë³‘ë ¬ë¡œ cpu ì‘ì—…ì„ í•  ìˆ˜ ìˆê³  ì´ë¥¼ ì´ìš©í•´ **ì—¬ëŸ¬ ì¥ë¹„ì—ì„œ ë™ì‘**í•˜ëŠ” ë¶„ì‚° ì²˜ë¦¬ í”„ë¡œê·¸ë˜ë°ë„ êµ¬í˜„ì´ ê°€ëŠ¥



<br>



#### multiprocessing ëª¨ë“ˆ 

`multiprocessing` ë©€í‹° í”„ë¡œì„¸ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ 2ê°€ì§€ ë˜ëŠ” ê·¸ ì´ìƒì˜ ì¼ì„ ë™ì‹œì— ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” í‘œì¤€ ëª¨ë“ˆ

multiprocessing ëª¨ë“ˆì€ ì“°ë ˆë“œ ëŒ€ì‹  **ë‹¤ì¤‘ í”„ë¡œì„¸ìŠ¤ë¥¼ ë§Œë“¤ì–´** ë³‘ë ¬ë¡œ ë™ì‘


```python
import multiprocessing
import time
```



### Multiprocessing Python ì˜ˆì‹œ

#### multiprocessing ì„ ì‚¬ìš©í•˜ì§€ ì•Šì„ ê²½ìš°


```python
# 0ë¶€í„° 50,000,000 ê¹Œì§€ì˜ í•©ì„ êµ¬í•˜ëŠ” í”„ë¡œê·¸ë¨
def work(id, start, end, result):
    total = 0
    for i in range(start, end):
        total += i
    result.append(total)
    return
```


```python
if __name__ == "__main__":
    start = time.time()
    
    START, END = 0, 50000000
    result = list()
    
    # ì‹±ê¸€ í”„ë¡œì„¸ìŠ¤ 2ë²ˆ ì‹¤í–‰
    for i in range(2):
        work(1, START, END, result)
        print(f'{i+1} ë²ˆì§¸ ì‹¤í–‰')
        
    
    time_elapsed1 = round(time.time() - start, 2)
    print(time_elapsed1, ' ì´ˆ ê²½ê³¼')
    print(f"í•©ê³„ ê²°ê³¼: {sum(result)}")
```

    1 ë²ˆì§¸ ì‹¤í–‰
    2 ë²ˆì§¸ ì‹¤í–‰
    1.88  ì´ˆ ê²½ê³¼
    í•©ê³„ ê²°ê³¼: 2499999950000000



<br>

#### multiprocessing ì„ ì‚¬ìš©í•  ê²½ìš°


```python
if __name__ == "__main__":
    start = time.time()
    
    START, END = 0, 50000000
    result = list()
    
    procs = [] # ê° processë¥¼ ë‹´ëŠ” list
    for i in range(2):
        # í”„ë¡œì„¸ìŠ¤ ìˆ˜ë§Œí¼ ì½”ì–´ í• ë‹¹
        p = multiprocessing.Process(target=work, args=(i, START, END, result))
        # target : êµ¬ë™í•  í•¨ìˆ˜
        # args : process id,í•¨ìˆ˜ì— ë“¤ì–´ê°ˆ ì¸ì ë“¤ 
        p.start()
        procs.append(p)
        print(f'{i+1} ë²ˆì§¸ ì‹¤í–‰')

    for p in procs:
        p.join()  # í”„ë¡œì„¸ìŠ¤ê°€ ëª¨ë‘ ì¢…ë£Œë  ë•Œê¹Œì§€ ëŒ€ê¸°
        
        
    time_elapsed2 = round(time.time() - start, 2)
    speed_up = round(time_elapsed1/time_elapsed2, 1)
    print(time_elapsed2, ' ì´ˆ ê²½ê³¼')
    print(speed_up, ' ë°° ì†ë„ í–¥ìƒ')
    print(f"í•©ê³„ ê²°ê³¼: {sum(result)}")
```

    1 ë²ˆì§¸ ì‹¤í–‰
    2 ë²ˆì§¸ ì‹¤í–‰
    0.77  ì´ˆ ê²½ê³¼
    2.4  ë°° ì†ë„ í–¥ìƒ
    í•©ê³„ ê²°ê³¼: 0

