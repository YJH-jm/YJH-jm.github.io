---
layout: single
title:  "ArcFace: Additive Angular Margin Loss for Deep Face Recognition" # 글 제목
categories: 
  - Face Recognition # category
tags: 
  - [] # tag
toc: true # 오른쪽의 table of contents
toc_sticky: true # 스크롤 내려도 toc 고정
toc_label: 목차
author_profile: false
# sidebar: # 왼쪽 사이드 바
    # nav: "docs"
search: true # 글 검색 안됨
use_math: true
typore-root-url: ../

---

****

### ArcFace: Additive Angular Margin Loss for Deep Face Recognition

CVPR 2019

[논문](https://arxiv.org/pdf/1801.07698v4.pdf)



Face recognition에서 angular margin을 주는 loss function을 소개하는 논문 



<center style="font-size:12px;">
    <a href="https://www.researchgate.net/figure/The-yaw-pitch-and-roll-angles-in-the-human-head-motion-11_fig1_305684696"> 출처 </a>
</center>



#### Introduction

Face Recognition을 위한 DCNNs을 학습하는 2가지 큰 연구 방향 존재

1. 다른 identities들을 분류 할 수 있는 multi-class classifier 학습
   - softmax classifier
2. 임베딩 직접 학습
   - triplet loss

대규모 데이터셋에서 face recognition에서 좋은 성능을 낼 수 있지만 단점 존재

<br>

Softmax classifier의 단점combinatorial explosion in the number of face triplets 

- 학습된 feature들은 폐쇄형 (closed-set) 분류 문제에서는 분류가 가능하지만 개방형 (open-set) 얼굴 인식에서는 어려움
- 선형 변환 행렬 $W \in\mathbb{R}^{d\\times N}$ 이 identity의 수 N에 따라 선형 증가



<br>

Triplet loss의 단점

- 대규모 데이터셋은 face triplet  조합이 폭발적으로 증가 
  - 상당한 iteration step의 증가를 가지고 옴
- 효과적인 모델 학습을 위한 semi-hard sample mining의 어려움

<br>

margin의 이득을 보고 sampling 문제는 피하기 위해 최근에는 margin penalty와 softmax loss와 통합하는 데 초점을 맞춤

Softmax loss는 embedding feature 선형 변환 행렬 간의 곱셈 단계에서global sample-to-class 비교를 수행



<br>

Sphereface 는 angular margin에 대한 중요한 idea를 도입했지만 loss 계산을 위한 일련의 근사값들이 필요해서 학습이 불안정함

- 학습을 안전화시키기 위해 softmax loss를 포함하는 hybrid loss 제시
- 경험적으로 softmax loss가 학습 과정 지배





#### Proposed Approach

##### ArcFace

Softmax <br>


$$
L1=-\log{\frac{e^{W_{y_{i}}^{T}x_{i}+b_{y_{i}}}}{\sum_{j=1}^{N}e^{W_{j}^{T}x_{i}+b_{j}}}}
$$

- $x_{i}$ : $i$번째 sample의 

Hypersphere Loss



**Numerical Similarity**

SphereFace

- Softmax 함수에서 W 정규화해주고 angular 공간을 이용해 feature 구분
- Angular margin을 통해 intra-class variance를 최소화하고 inter-class variance 최대화

$$
L_{ang}=\frac{1}{N}-\log \left ( \frac{}{}  \right )
$$

- $m$ : angular margin



<br>

CosFace

Feature x 도 정규화

Angular margin을 cosine 값 자체에 더함





![image-20240313214146202](/images/2024-03-13-5/image-20240313214146202.png)

- 정규화 된 feature와 정규화 된 weight 이용
- arcface의 특징은 각도에 직접적인 margin을 줌
- 그 후에 softmax를 적용
